<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Chrono Pro</title>
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#0a0a0a">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <div id="app-container" class="container">
        <!-- --- TIMER VIEW --- -->
        <div id="view-timer" class="view-section active">
            <div class="timer-header">
                <p id="timer-display" contenteditable="true" inputmode="decimal">20:00</p>
                <div id="end-time-display"></div>
            </div>

            <div class="button-group">
                <button class="preset-btn" data-time="5" onclick="Timer.set(5, this)">
                    <span class="preset-val" contenteditable="true" onclick="event.stopPropagation()"
                        onblur="Timer.savePreset(this)">5</span>m
                </button>
                <button class="preset-btn active" data-time="20" onclick="Timer.set(20, this)">
                    <span class="preset-val" contenteditable="true" onclick="event.stopPropagation()"
                        onblur="Timer.savePreset(this)">20</span>m
                </button>
                <button class="preset-btn" data-time="45" onclick="Timer.set(45, this)">
                    <span class="preset-val" contenteditable="true" onclick="event.stopPropagation()"
                        onblur="Timer.savePreset(this)">45</span>m
                </button>
                <button class="preset-btn" data-time="60" onclick="Timer.set(60, this)">
                    <span class="preset-val" contenteditable="true" onclick="event.stopPropagation()"
                        onblur="Timer.savePreset(this)">60</span>m
                </button>
            </div>

            <div class="controls">
                <button id="toggle-btn" class="control-btn" onclick="Timer.toggle()">
                    <svg id="play-icon" viewBox="0 0 24 24">
                        <path d="M8 5v14l11-7z" />
                    </svg>
                    <svg id="pause-icon" viewBox="0 0 24 24" style="display:none;">
                        <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z" />
                    </svg>
                </button>
            </div>
        </div>

        <!-- --- ALARM VIEW --- -->
        <div id="view-alarm" class="view-section">
            <div id="next-alarm-info"></div>
            <div id="alarm-list-container"></div>
        </div>

        <!-- --- STOPWATCH VIEW --- -->
        <div id="view-stopwatch" class="view-section">
            <div id="sw-display">00:00.00</div>

            <div class="controls">
                <button id="sw-lap-reset-btn" class="control-btn" style="background:#222; color:#fff; opacity:0.3;"
                    onclick="Stopwatch.lapOrReset()">
                    <span id="sw-lap-text" style="font-size:0.9rem; font-weight:600;">Reset</span>
                </button>
                <button id="sw-btn" class="control-btn" onclick="Stopwatch.toggle()">
                    <svg viewBox="0 0 24 24">
                        <path d="M8 5v14l11-7z" />
                    </svg>
                </button>
            </div>

            <div id="sw-tracking-stats" class="tracking-stats" style="display:none;">
                <div class="stat-item">
                    <span id="sw-speed" class="stat-value">0</span>
                    <span class="stat-label">MPH</span>
                </div>
                <div class="stat-item">
                    <span id="sw-distance" class="stat-value">0</span>
                    <span class="stat-label">Miles</span>
                </div>
            </div>

            <div id="sw-laps" class="stopwatch-laps" style="display:none;"></div>
        </div>
    </div>

    <!-- --- OVERLAYS --- -->
    <!-- Alarm Picker Modal -->
    <div id="modal-time-picker" class="modal-overlay" onclick="if(event.target===this) Alarm.closePicker()">
        <div class="modal-card">
            <button id="modal-delete-btn" class="delete-btn-corner" onclick="Alarm.delete()">
                <svg viewBox="0 0 24 24">
                    <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z" />
                </svg>
            </button>
            <div class="modal-title">Set Alarm</div>
            <div class="wheel-container">
                <div class="wheel-highlight"></div>
                <div id="wheel-hour" class="wheel-col col-hour"></div>
                <div class="col-sep">:</div>
                <div id="wheel-min" class="wheel-col col-min"></div>
                <div id="wheel-ampm" class="wheel-col col-ampm"></div>
            </div>

            <div class="day-selector">
                <div class="day-btn" data-day="1">M</div>
                <div class="day-btn" data-day="2">T</div>
                <div class="day-btn" data-day="3">W</div>
                <div class="day-btn" data-day="4">T</div>
                <div class="day-btn" data-day="5">F</div>
                <div class="day-btn" data-day="6">S</div>
                <div class="day-btn" data-day="0">S</div>
            </div>

            <div style="margin-bottom: 25px; width:100%; text-align:left;">
                <label style="font-size:0.8rem; color:#888; display:block; margin-bottom:8px;">Sound</label>
                <div style="display:flex; align-items:center; gap:10px;">
                    <span id="current-sound-name"
                        style="font-size:0.9rem; color:#fff; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; flex:1;">Default
                        Beep</span>
                    <button class="btn-text" style="padding:5px 10px;"
                        onclick="document.getElementById('sound-input').click()">Pick</button>
                </div>
                <input type="file" id="sound-input" accept="audio/*" style="display:none"
                    onchange="Alarm.handleFileSelect(event)">
            </div>

            <div style="display:flex; gap:10px; width:100%;">
                <button class="btn-text" style="flex:1; color:#888;" onclick="Alarm.closePicker()">Cancel</button>
                <button class="btn-text" style="flex:1;" onclick="Alarm.save()">Save</button>
            </div>
        </div>
    </div>

    <!-- Alarm Ringing Overlay -->
    <div id="alarm-ring-overlay" class="modal-overlay" style="background:var(--bg); z-index:300;">
        <div style="text-align:center;">
            <div id="ring-current-time">12:00 PM</div>
            <div id="ring-countdown">00:00</div>
            <div id="ring-controls">
                <button id="btn-snooze" class="ring-btn ring-snooze" onclick="Alarm.snooze()">Snooze</button>
                <button class="ring-btn ring-stop" onclick="Alarm.stopRing()">Stop</button>
            </div>
        </div>
    </div>

    <button id="fab-add-alarm" class="fab-add" onclick="Alarm.openPicker()" style="display:none;">+</button>

    <!-- NAVIGATION -->
    <div class="nav-trigger"></div>
    <div id="bottom-nav" class="bottom-nav">
        <div id="nav-timer" class="nav-item active" onclick="App.switchTab('timer', this)">
            <svg class="nav-icon" viewBox="0 0 24 24">
                <path
                    d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z" />
                <path d="M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z" />
            </svg>
        </div>
        <div id="nav-alarm" class="nav-item" onclick="App.switchTab('alarm', this)">
            <svg class="nav-icon" viewBox="0 0 24 24">
                <path
                    d="M22 5.72l-4.6-3.86-1.29 1.53 4.6 3.86L22 5.72zM7.88 3.39L6.6 1.86 2 5.71l1.29 1.53 4.59-3.85zM12.5 8H11v6l4.75 2.85.75-1.23-4-2.37V8zM12 4c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9-4.03-9-9-9zm0 16c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z" />
            </svg>
        </div>
        <div id="nav-stopwatch" class="nav-item" onclick="App.switchTab('stopwatch', this)">
            <svg class="nav-icon" viewBox="0 0 24 24">
                <path
                    d="M19.03 7.39l1.42-1.42c-.43-.51-.9-.99-1.41-1.41l-1.42 1.42C16.07 4.74 14.12 4 12 4c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-2.12-.74-4.07-1.97-5.61zM12 20c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7zm1-9h-2v4h4v-2h-2v-2zM15 1H9v2h6V1z" />
            </svg>
        </div>
    </div>

    <!-- JS MODULES -->
    <script src="js/background.js"></script>
    <script src="js/audio.js"></script>
    <script src="js/timer.js"></script>
    <script src="js/stopwatch.js"></script>
    <script src="js/alarm.js"></script>
    <script src="js/app.js"></script>
</body>

</html>